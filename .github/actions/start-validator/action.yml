name: Start validator

inputs:
  node:
    description: The Node.js version to install
    required: true
  solana:
    description: The Solana version to install
    required: true
  cache:
    description: Whether we should cache files between workflow runs
    required: true

runs:
  using: "composite"
  steps:
    - name: Download program builds
      id: download
      uses: actions/download-artifact@v3
      with:
        name: program-builds

    - name: Install Solana
      uses: metaplex-foundation/actions/install-solana@v1
      with:
        version: ${{ inputs.solana }}
        cache: ${{ inputs.cache }}

    - name: Install Node.js
      uses: metaplex-foundation/actions/install-node-with-pnpm@v1
      with:
        version: ${{ inputs.node }}
        cache: ${{ inputs.cache }}
        dependencies: true

    - name: Start local validator
      run: pnpm validator
      shell: bash
